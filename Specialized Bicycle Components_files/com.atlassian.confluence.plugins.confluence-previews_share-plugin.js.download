WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}};try{if(typeof FileViewer=='undefined'){var FileViewer={};}
if(typeof FileViewer.Templates=='undefined'){FileViewer.Templates={};}
FileViewer.Templates.controlShareButton=function(opt_data,opt_ignored){return '<a id="cp-control-panel-share" href="#" title="'+soy.$$escapeHtml('Share')+'" class="cp-icon cp-share-icon"></a>';};if(goog.DEBUG){FileViewer.Templates.controlShareButton.soyTemplateName='FileViewer.Templates.controlShareButton';}}catch(e){WRMCB(e)};;try{define("cp/component/share-button/share-button-plugin",["jquery","ajs","backbone","core/template-store-singleton","confluence/share-page/service/share-page"],function(g,b,h,e,f){var a=null;var c=h.View.extend({tagName:"span",initialize:function(i){this._mediaViewer=i.mediaViewer},teardown:function(){if(a){a.remove();a=null}},render:function(){var i=this;this.$el.html(e.get("controlShareButton")());if(g.fn.tooltip){this.$("a").tooltip({gravity:"n"})}setTimeout(function(){i.postRender()},0);return this},postRender:function(){var k=this;var j="#cp-control-panel-share";var i=g(j);f.initDialog(j,"sharePreviewPopup",{},{heading:"Share this file",notePlaceholder:"Take a look at this file",link:function(){return window.location},entityId:function(){return k._mediaViewer.getCurrentFile().get("id")},copyOption:"share",shareType:"attachment",contentType:"attachment",errorText:"An unexpected error occurred. Please try again.",beforeLoad:function(){i.find(".aui-icon").css("visibility","hidden");i.removeClass("cp-share-icon");i.parent().spin({top:"17px",left:"17px",color:"white"})},afterLoad:function(){i.find(".aui-icon").css("visibility","visible");i.parent().spinStop();i.addClass("cp-share-icon")},onShow:function(l){k._mediaViewer.getView().lockNavigationKeys();l.attr("data-fv-allow-focus",1);a=i.data("dialog");k._mediaViewer.trigger("media-viewer-menu-button-dialog-opened")},onHide:function(){k._mediaViewer.getView().unlockNavigationKeys()}})}});var d=function(i){if(!i.getConfig().enableShareButton){return}i.getView().fileControlsView.addLayerView("shareButton",c,{weight:2,predicate:function(j){return!j.getCurrentFile().get("isRemoteLink")}})};return d});(function(){var a=require("cp/component/share-button/share-button-plugin");var b=require("MediaViewer");b.registerPlugin("sharebutton",a)})();}catch(e){WRMCB(e)};