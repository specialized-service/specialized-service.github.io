WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}};try{(function(a,e,d){var f=AJS.$;AppLinks=f.extend(window.AppLinks||{},{Event:{NAMESPACE:"applinks"},I18n:a,Docs:e});AppLinks.Event=f.extend(window.AppLinks.Event,d);if(AJS.AppLinksInitialisationBinder){AppLinks.initialisationBinder=AJS.AppLinksInitialisationBinder}else{AppLinks.initialisationBinder=function(h){AJS.toInit(h)}}function b(k){var h=k.responseText;var j;try{j=JSON.parse(h)}catch(i){console&&console.error&&console.error("invalid JSON response",h,k)}return j||{}}var g=new RegExp("rest/applinks(?:.*?)/(\\d\\.\\d|\\d)/");function c(h){var i=g.exec(h);return i&&i.length===2?i[1]:false}AppLinks.initialisationBinder(function(){AppLinks=f.extend(window.AppLinks||{},{failure:function(j){if(j.status==401){window.location.reload()}else{var h=AppLinks.parseError(j);var i=f(".page-error");if(i.length>0){i.html(h).fadeIn("slow")}else{alert("REST request failed: "+h)}}},jsonRequest:function(i,k,l,m,h,j){if(l){l=JSON.stringify(l)}f(".page-error").fadeOut("fast");if(!h){h=AppLinks.failure}return jQuery.ajax({url:i,type:k,data:l,dataType:"json",contentType:"application/json; charset=utf-8",beforeSend:j,cache:false,success:m,error:h,jsonp:false})},xmlRequest:function(i,k,l,m,h,j){if(l){l=JSON.stringify(l)}f(".page-error").fadeOut("fast");if(!h){h=AppLinks.failure}return jQuery.ajax({url:i,type:k,data:l,dataType:"xml",contentType:"application/xml; charset=utf-8",beforeSend:j,cache:false,success:m,error:h})},parseError:function(j){var h=b(j);var i=h&&h.message;if(i){return f.isArray(i)?i.join(" "):i}if(j){return j.statusText?j.statusText:j}return"An unknown error occurred. Check the console logs for details."},put:function(i,k,l,h,j){return AppLinks.jsonRequest(i,"PUT",k,l,h,j)},post:function(i,k,l,h,j){return AppLinks.jsonRequest(i,"POST",k,l,h,j)},update:function(k,m,i,j){var h=AppLinks.self_link(k);var l=c(h)==="1.0"?AppLinks.put:AppLinks.post;l(h,k,m,i,j)},get:function(i,k,h,j){return AppLinks.jsonRequest(i,"GET",null,k,h,j)},getXml:function(i,k,h,j){return AppLinks.xmlRequest(i,"GET",null,k,h,j)},self_link:function(k){for(var h=0,l=k.link.length;h<l;h++){var j=k.link[h];if(j.rel=="self"){return j.href}}throw"No self-link found"},del:function(l,k,i,j){var h;if(typeof(l)=="string"){h=l}else{h=AppLinks.self_link(l)}return AppLinks.jsonRequest(h,"DELETE",null,k,i,j)},SPI:f.extend({},{API_VERSION:"1.0",REST_RESOURCE_URL:AJS.contextPath()+"/rest/applinks/",BASE_URL:AJS.contextPath()+"/rest/applinks/1.0",OAUTH_REST_RESOURCE_URL:AJS.contextPath()+"/rest/applinks-oauth/",OAUTH_BASE_URL:AJS.contextPath()+"/rest/applinks-oauth/1.0",setApiVersion:function(h){AppLinks.SPI.API_VERSION=h;AppLinks.SPI.setBaseUrl(AppLinks.SPI.REST_RESOURCE_URL+AppLinks.SPI.API_VERSION)},setBaseUrl:function(h){AppLinks.SPI.BASE_URL=h},setOAuthBaseUrl:function(h){AppLinks.SPI.OAUTH_BASE_URL=h},getRemoteRestBaseUrl:function(h){return h+"/rest/applinks/"+AppLinks.SPI.API_VERSION},getRemotePluginServletBaseUrl:function(h){return h+"/plugins/servlet"},getAllLinks:function(j,i){var h=AppLinks.SPI.BASE_URL+"/applicationlink";return AppLinks.get(h,j,i)},getAllLinksWithAuthInfo:function(j,i){var h=AppLinks.SPI.BASE_URL+"/listApplicationlinks";return AppLinks.get(h,j,i)},getApplicationLinkState:function(k,j,i){var h=AppLinks.SPI.BASE_URL+"/listApplicationlinkstates/id/"+k;return AppLinks.get(h,j,i)},getLinksOfType:function(j,k,i){var h=AppLinks.SPI.BASE_URL+"/applicationlink/type/"+j;return AppLinks.get(h,k,i)},tryToFetchManifest:function(j,k,i){var h=AppLinks.SPI.BASE_URL+"/applicationlinkForm/manifest.json?url="+encodeURIComponent(j);return AppLinks.get(h,k,i,function(l){l.setRequestHeader("X-Atlassian-Token","no-check")})},getManifestFor:function(k,j,i){var h=AppLinks.SPI.BASE_URL+"/manifest/"+k+".json";return AppLinks.get(h,j,i)},getLocalManifest:function(j,i){var h=AppLinks.SPI.BASE_URL+"/manifest.json";return AppLinks.get(h,j,i)},getRemoteManifest:function(j,k,i){var h=AppLinks.SPI.getRemoteRestBaseUrl(j)+"/manifest.json";return AppLinks.get(h,k,i)},getRemoteOAuthConsumerInfo:function(j,k,i){var h=AppLinks.SPI.getRemotePluginServletBaseUrl(j)+"/oauth/consumer-info";return AppLinks.getXml(h,k,i)},getApplinkStatus:function(k,j,i){var h=AppLinks.SPI.BASE_URL+"/status/"+k;return AppLinks.get(h,j,i)},createStaticUrlAppLink:function(k,j,i){var h=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createStaticUrlAppLink?typeId="+k;return AppLinks.post(h,null,j,i)},createLink:function(o,m,q,i,n,p,k,r,j){var h=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var l={applicationLink:o,username:m,password:q,createTwoWayLink:i,customRpcURL:n,rpcUrl:p,configFormValues:k};return AppLinks.post(h,l,r,j)},createLinkWithOrphanedTrust:function(o,m,r,i,n,p,k,q,s,j){var h=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var l={applicationLink:o,username:m,password:r,createTwoWayLink:i,customRpcURL:n,rpcUrl:p,configFormValues:k,orphanedTrust:q};return AppLinks.post(h,l,s,j)},verifyTwoWayLinkDetails:function(h,n,o,k,m,j){var i=AppLinks.SPI.BASE_URL+"/applicationlinkForm/details";var l={username:o,password:k,remoteUrl:h,rpcUrl:n};return AppLinks.post(i,l,m,j)},getApplicationLinkInfo:function(j,k,i){var h=AppLinks.SPI.BASE_URL+"/applicationlinkInfo/id/"+j;return AppLinks.get(h,k,i)},deleteLink:function(l,h,k,j){var i=AppLinks.SPI.BASE_URL+"/applicationlink/"+l.id;if(h){i+="?reciprocate=true"}return AppLinks.del(i,k,j)},makePrimary:function(j,i){var h=AppLinks.SPI.BASE_URL+"/applicationlink/primary/"+j.id;return AppLinks.post(h,null,i)},relocate:function(m,k,h,l,j){var i=AppLinks.SPI.BASE_URL+"/relocateApplicationlink/"+m.id+"?newUrl="+encodeURIComponent(k)+"&nowarning="+(h?"true":"false");return AppLinks.post(i,null,l,j)},legacyUpgrade:function(k,j,i){var h=AppLinks.SPI.BASE_URL+"/upgrade/legacy/"+k.id;return AppLinks.post(h,null,j,i)},ualUpgrade:function(l,h,k,j){var i=AppLinks.SPI.BASE_URL+"/upgrade/ual/"+l.id;return AppLinks.post(i,h,k,j)},getEntityTypesForApplicationType:function(k,j,i){var h=AppLinks.SPI.BASE_URL+"/type/entity/"+k;return AppLinks.get(h,j,i)},getLocalEntitiesWithLinksToApplication:function(h,k,j){var i=AppLinks.SPI.BASE_URL+"/entitylink/localEntitiesWithLinksTo/"+h+".json";return AppLinks.get(i,k,j)},getEntityLinksForApplication:function(h,k,j){var i=AppLinks.SPI.BASE_URL+"/entities/"+h+".json";AppLinks.get(i,k,j)},getEntityLinksForApplicationUsingAnonymousAccess:function(h,k,j){var i=AppLinks.SPI.BASE_URL+"/entities/anonymous/"+h+".json";return AppLinks.get(i,k,j)},createNonUalEntityLink:function(q,l,i,k,o,j,p,n){var h=AppLinks.SPI.BASE_URL+"/entitylink/"+q+"/"+l+"?reciprocate=false";var m={applicationId:i,typeId:k,key:o,name:j,isPrimary:false};return AppLinks.put(h,m,p,n)},createEntityLink:function(m,l,i,h,n,k){var j=AppLinks.SPI.BASE_URL+"/entitylink/"+m+"/"+l+"?reciprocate=";j+=(h?"true":"false");return AppLinks.put(j,i,n,k)},getConfiguredEntityLinks:function(k,j,l,i){var h=AppLinks.SPI.BASE_URL+"/entitylink/primaryLinks/"+k+"/"+j+".json";return AppLinks.get(h,l,i)},deleteEntityLink:function(m,l,i,h,n,k){var j=AppLinks.SPI.BASE_URL+"/entitylink/"+m+"/"+l+"?typeId="+i.typeId+"&key="+i.key+"&applicationId="+i.applicationId+"&reciprocate="+h;return AppLinks.del(j,n,k)},makePrimaryEntityLink:function(l,k,h,m,j){var i=AppLinks.SPI.BASE_URL+"/entitylink/primary/"+l+"/"+k+"?typeId="+h.typeId+"&key="+h.key+"&applicationId="+h.applicationId;return AppLinks.post(i,null,m,j)},canDeleteAppLink:function(k,j,i){var h=AppLinks.SPI.BASE_URL+"/permission/reciprocate-application-delete/"+k;return AppLinks.get(h,j,i)},canDeleteEntityLink:function(l,k,h,m,j){var i=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-delete/"+h.applicationId+"/"+l+"/"+k+"/"+h.typeId+"/"+h.key;return AppLinks.get(i,m,j)},canCreateReciprocateEntityLink:function(k,j,i){var h=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-create/"+k;return AppLinks.get(h,j,i)},processPermissionCode:function(i){var h={noPermission:function(){},missing:function(){},credentialsRequired:function(j){},authenticationFailed:function(j){},noAuthentication:function(j){},noAuthenticationConfigured:function(){},noConnection:function(){},allowed:function(){},unrecognisedCode:function(j){},updateView:function(l,k,j){}};if(!i){i={}}i=f.extend(h,i);return function(k){var j=k.code;if(j=="NO_PERMISSION"){i.noPermission()}else{if(j=="MISSING"){i.missing()}else{if(j=="CREDENTIALS_REQUIRED"){i.credentialsRequired(k.url)}else{if(j=="AUTHENTICATION_FAILED"){i.authenticationFailed(k.url)}else{if(j=="NO_AUTHENTICATION"){i.noAuthentication(k.url)}else{if(j=="NO_AUTHENTICATION_CONFIGURED"){i.noAuthenticationConfigured()}else{if(j=="NO_CONNECTION"){i.noConnection()}else{if(j=="ALLOWED"){i.allowed()}else{i.unrecognisedCode(k.code)}}}}}}}}}},addAuthenticationTrigger:function(j,h,i){if(!i){i={}}if(typeof i.onSuccess=="undefined"){i.onSuccess=function(){location.reload()}}if(typeof i.onFailure=="undefined"){i.onFailure=function(){return true}}f(j).off("click.applinks");f(j).on("click.applinks",function(){if(i.before){i.before()}AppLinks.authenticateRemoteCredentials(h,i.onSuccess,i.onFailure)})},deleteOrphanedTrust:function(l,j,k,i){var h=AppLinks.SPI.BASE_URL+"/orphaned-trust/"+j+"/"+l;return AppLinks.del(h,k,i)},getOrphanedTrust:function(j,i){var h=AppLinks.SPI.BASE_URL+"/orphaned-trust/";return AppLinks.get(h,j,i)},showCreateEntityLinkSuggestion:function(){return true},getApplicationLink:function(k,j,i){var h=AppLinks.SPI.BASE_URL+"/applicationlink/"+k;return AppLinks.get(h,j,i)},createApplicationLink:function(k,i,n,o,h,p,l){var j=AppLinks.SPI.BASE_URL+"/applicationlink";var m={id:k,name:i,rpcUrl:n,displayUrl:o,typeId:h};return AppLinks.put(j,m,p,l)},createConsumer:function(j,s,i,r,n,q,l,u,m,p,t,k){var h=AppLinks.SPI.OAUTH_BASE_URL+"/applicationlink/"+j+"/authentication/consumer";var o={key:s,name:i,description:r,sharedSecret:n,publicKey:q,outgoing:p,twoLOAllowed:l,executingTwoLOUser:u,twoLOImpersonationAllowed:m};return AppLinks.put(h,o,t,k)},createConsumerAutoConfigure:function(o,n,k,h,m,j){var i=AppLinks.SPI.OAUTH_BASE_URL+"/applicationlink/"+o+"/authentication/consumer?autoConfigure=true";var l={twoLOAllowed:n,executingTwoLOUser:k,twoLOImpersonationAllowed:h};return AppLinks.put(i,l,m,j)},registerProvider:function(n,m,j,l,i){var h=AppLinks.SPI.BASE_URL+"/applicationlink/"+n+"/authentication/provider";var k={config:j,provider:m};return AppLinks.put(h,k,l,i)},enableFeature:function(j,k,i){var h=AppLinks.SPI.BASE_URL+"/features/"+j;return AppLinks.put(h,{},k,i)},disableFeature:function(j,k,i){var h=AppLinks.SPI.BASE_URL+"/features/"+j;return AppLinks.del(h,k,i)}},(window.AppLinks&&window.AppLinks.SPI)||{})});AppLinks.UI={showInfoBox:function(h){f(".aui-message.aui-message-success").remove();AppLinks.UI.createMessage("success",h,"page-info")},hideInfoBox:function(){f(".aui-message.aui-message-success").remove()},showErrorBox:function(h){AppLinks.UI.createMessage("error",h,"page-error")},hideErrorBox:function(){f(".aui-message.aui-message-error").remove()},showWarningBox:function(i){if(f.isArray(i)&&i.length>0){var h=f("<ul></ul>");f(i).each(function(k){h.append(f("<li/>",{text:i[k]}))});var j=f('<div class="page-warning"></div>').append(h);AppLinks.UI.createMessage("warning",j.html(),"page-warning")}else{AppLinks.UI.createMessage("warning",i,"page-warning")}},hideWarningBox:function(){f(".aui-message.aui-message-warning").remove()},shortenString:function(i,h){if(i.length>h){i=i.substring(0,h)+"..."}return i},createMessage:function(i,j,h){var k=f('<div class="'+h+'">');k.html(j);AJS.messages[i](".applinks-message-bar",{title:"",body:k.wrap("<div></div>").parent().html(),closeable:true});f(document).trigger(AppLinks.Event.Legacy.MESSAGE_BOX_DISPLAYED)},displayValidationErrorMessages:function(h,j,i){if(f.isArray(i)){f(i).each(function(m,l){var n=f('<div class="error applinks-error">');n.text(l);f(j).find("."+h).append(n)})}else{if(typeof i!="undefined"){var k=f('<div class="error applinks-error">');k.text(i.toString());f(j).find("."+h).append(k)}}},displayValidationError:function(h,i,j){return function(n){if(n.status==401){window.location.reload();return}f(".applinks-error").remove();f(".loading").remove();var m=b(n);var l=m.message;if(typeof m.fields=="undefined"){AppLinks.UI.displayValidationErrorMessages(h,i,l)}else{var k=m.fields;f(k).each(function(o){var p=f('<div class="error applinks-error" id="'+k[o]+'-error">');p.text(l[o]);if(f(i).find("."+k[o]).length>0){p.insertAfter(f(i).find("."+k[o]))}else{p.insertAfter(f(i).find("."+h).append(p))}})}f(i).find("."+h).addClass("fully-populated-errors");if(j){j()}}},addProtocolToURL:function(h){var k=f.trim(h);var j=k.toLowerCase();var i=false;if(j.length>=7){if(j.substring(0,7).indexOf("http")!=-1){i=true}}if(!i){k="http://"+k}return k},prettyJoin:function(i,l,k){if(!k){k="and"}var h=i.length;var j="";f.each(i,function(m,n){if(m==(h-1)&&h>1){j+=" "+k+"  "+l(n)}else{j+=l(n);if(m+2<h){j+=", "}}});return j},showLoadingIcon:function(h){f('<span class="loading">&nbsp;</span>').insertAfter(h)},hideLoadingIcon:function(h){f(h).next(".loading").remove()},findUrl:function(k){var j=undefined;var l=k.toLowerCase();var i=l.indexOf("http:");if(i==-1){i=l.indexOf("https:")}if(i>-1){var h=l.indexOf(" ",i);if(h==-1){h=l.length}j=k.substring(i,h)}return j},findApplicationType:function(h){h=h.toLowerCase();if(h.indexOf("jira")!=-1){return"jira"}else{if(h.indexOf("fisheye")!=-1){return"fecru"}else{if(h.indexOf("confluence")!=-1){return"confluence"}else{if(h.indexOf("refapp")!=-1){return"refapp"}else{return undefined}}}}},escapeSelector:function(h){return h.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g,"\\$1")},sanitiseHTML:function(h){var i={"<":"&lt;",'"':"&quot;","&":"&amp;"};return h.replace(/[<"&]/g,function(j){return i[j]})},refreshOrphanedTrust:function(){var h=function(i){f("tr.orphaned-trust-row").each(function(){var n=f(this);var o=n.attr("data-id");var l=n.attr("data-type");var k=false;for(var j=0;j<i.orphanedTrust.length;j++){var m=i.orphanedTrust[j];if(o==m.id&&l==m.type){k=true;break}}if(!k){n.remove();if(i.orphanedTrust.length==0){f(".orphaned-trust-warning").hide()}}})};AppLinks.SPI.getOrphanedTrust(h)},removeCssClass:function(h,i){f(h).removeClass(function(k,m){var l=m.split(" ");var j="";f.each(l,function(n,o){if(o.indexOf(i)!=-1){j=o}});return j})}};(function(){var h=f({});f.each(["bind","unbind","trigger"],function(j,k){AppLinks.UI[k]=function(){return h[k].apply(h,arguments)}})})();f(document).trigger(AppLinks.Event.PREREADY);f(document).trigger(AppLinks.Event.READY)})})(require("applinks/common/i18n"),require("applinks/common/docs"),require("applinks/common/events"));}catch(e){WRMCB(e)};;try{AJS.$(document).bind(AppLinks.Event.READY,function(){AppLinks.autoComplete={cacheManager:function(c){var a={},b=[],c=c||30;return{get:function(d){return a[d]},put:function(d,e){a[d]=e;b.push(d);if(b.length>c){delete a[b.shift()]}},clear:function(){a={};b=[]}}}};(function(d){var c=function(f){AJS.log("InputDrivenDropDown: truncating text");var h=f.$.closest(".aui-dropdown").width(),g=20;d("a span:not(.icon)",f.$).each(function(){var j=d(this),i=d("<var></var>").html("&#8230;"),l=i.width(),k=false;j.wrapInner(d("<em>"));d("em",j).each(function(){var m=d(this);m.show();if(this.offsetLeft+this.offsetWidth>h){var t=this.childNodes,s=false;for(var o=t.length-1;o>=0;o--){var p=t[o],n=1,r=(p.nodeType==3)?"nodeValue":"innerHTML",q=p[r];do{if(n<=q.length){p[r]=q.substr(0,q.length-n++)}else{break}}while(this.offsetLeft+this.offsetWidth+l>h-g);if(n<=q.length){s=true;break}}if(s){k=true}else{m.hide()}}});if(k){j.append(i);this.elpss=i}})};var b=function(f,l){if(!l.length||!l[0]){return}AJS.log("InputDrivenDropDown: highlighting tokens");for(var h=0,j=l.length;h<j;h++){var g=l[h];l[h]=g?g.replace(/[\.\*\+\?\|\(\)\[\]{}\\]/g,"\\$"):""}var k=new RegExp("("+l.join("|")+")","gi");d("li a:not(.dropdown-prevent-highlight) span",f.$).each(function(){var m=d(this),i=m.html().replace(k,"<strong>$1</strong>");m.html(i)})};var e=function(j,g){var i=j.options,h=j.dd;if(h){h.hide();h.$.remove()}i.ajsDropDownOptions=i.ajsDropDownOptions||{};if(i.ajsDropDownOptions&&!i.ajsDropDownOptions.alignment){i.ajsDropDownOptions.alignment="left"}i.ajsDropDownOptions.selectionHandler=i.ajsDropDownOptions.selectionHandler||function(l,k){if(l.type!="click"){l.preventDefault();d("a",k).click();document.location=d("a",k).attr("href")}};i.ajsDropDownOptions.displayHandler=function(k){return AJS.escapeHtml(k.name)};var f=j.dd=new AJS.dropDown(g.matrix,i.ajsDropDownOptions)[0];if(i.ajsDropDownOptions&&i.ajsDropDownOptions.className){f.$.addClass(i.ajsDropDownOptions.className)}if(i.dropdownPlacement){i.dropdownPlacement(f.$)}else{AJS.log("No dropdownPlacement function specified. Appending dropdown to the body.");d("body").append(f.$)}b(f,g.queryTokens||[g.query]);c(f);if(i.dropdownPostprocess){i.dropdownPostprocess(f.$)}f.show(j._effect);if(typeof i.onShow=="function"){i.onShow.call(f,f.$)}return f};function a(g,f){this._effect="appear";this._timer=null;this.id=g;this.options=f;this.inactive=false;this.busy=false;this.cacheManager=AppLinks.autoComplete.cacheManager()}a.prototype.clearCache=function(){this.cacheManager.clear()};a.prototype.change=function(h,g){var f=this;if(h!=f._value||g){f._value=h;f.busy=false;clearTimeout(f._timer);if(g||(/\S{0,}/).test(h)){var i=f.cacheManager.get(h);if(i){e(f,i)}else{f.busy=true;f._timer=setTimeout(function(){f.options.getDataAndRunCallback.call(f,h,f.show)},200)}}else{f.dd&&f.dd.hide()}}};a.prototype.dropDownLength=function(){return this.dd.links?this.dd.links.length:0};a.prototype.dropDownItem=function(f){return this.dropDownLength()>f?this.dd.links[f]:null};a.prototype.hide=function(){this.dd&&this.dd.hide()};a.prototype.remove=function(){var f=this.dd;if(f){this.hide();f.$.remove()}this.inactive=true;this.options.onDeath&&this.options.onDeath()};a.prototype.show=function(g,i,h){if(this.inactive){AJS.log("Quick search abandoned before server response received, ignoring. "+this);return}var f={matrix:g,query:i,queryTokens:h};this.cacheManager.put(i,f);e(this,f);this.busy=false};AppLinks.inputDrivenDropdown=function(f){return new a("inputdriven-dropdown",f)}})(jQuery)});}catch(e){WRMCB(e)};;try{if(jQuery!=undefined&&AJS!=undefined){jQuery=AJS.$};}catch(e){WRMCB(e)};